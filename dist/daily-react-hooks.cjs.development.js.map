{"version":3,"file":"daily-react-hooks.cjs.development.js","sources":["../src/DailyContext.tsx","../src/DailyEventContext.tsx","../src/hooks/useDaily.ts","../src/hooks/useDailyEvent.ts","../src/hooks/useThrottledDailyEvent.ts","../src/utils/resolveParticipantPath.ts","../src/DailyParticipants.tsx","../src/DailyRoom.tsx","../src/DailyProvider.tsx","../src/hooks/useParticipant.ts","../src/hooks/useActiveParticipant.ts","../src/hooks/useAppMessage.ts","../src/hooks/useMediaTrack.ts","../src/hooks/useAudioTrack.ts","../src/hooks/useDevices.ts","../src/hooks/useInputSettings.ts","../src/hooks/useLiveStreaming.ts","../src/hooks/useLocalParticipant.ts","../src/hooks/useLocalSessionId.ts","../src/hooks/useNetwork.ts","../src/hooks/useParticipantIds.ts","../src/hooks/useParticipantProperty.ts","../src/hooks/useReceiveSettings.ts","../src/hooks/useRecording.ts","../src/hooks/useRoom.ts","../src/hooks/useScreenAudioTrack.ts","../src/hooks/useScreenShare.ts","../src/hooks/useScreenVideoTrack.ts","../src/hooks/useVideoTrack.ts","../src/hooks/useWaitingParticipants.ts"],"sourcesContent":["import { DailyCall } from '@daily-co/daily-js';\nimport { createContext } from 'react';\n\nexport const DailyContext = createContext<DailyCall | null>(null);\n","import { DailyEvent } from '@daily-co/daily-js';\nimport { createContext } from 'react';\n\ninterface EventContextValue {\n  on(ev: DailyEvent, callback: Function, key: number): void;\n  off(ev: DailyEvent, key: number): void;\n}\n\nexport const DailyEventContext = createContext<EventContextValue>({\n  on: () => {},\n  off: () => {},\n});\n","import { useContext } from 'react';\n\nimport { DailyContext } from '../DailyContext';\n\n/**\n * Returns callObject instance passed to or created by closest <DailyProvider>.\n */\nexport const useDaily = () => {\n  const daily = useContext(DailyContext);\n  return daily;\n};\n","import { DailyEvent, DailyEventObject } from '@daily-co/daily-js';\nimport { useContext, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { DailyEventContext } from '../DailyEventContext';\n\ntype EventCallback = (event?: DailyEventObject) => void;\n\nlet uniqueCounter = 0;\nexport const getUnique = () => uniqueCounter++;\n\n/**\n * Sets up a daily event listener using [on](https://docs.daily.co/reference/daily-js/instance-methods/on) method.\n * When this hook is unmounted the event listener is unregistered using [off](https://docs.daily.co/reference/daily-js/instance-methods/off).\n *\n * Warning: callback has to be a memoized reference (e.g. via [useCallback](https://reactjs.org/docs/hooks-reference.html#usecallback)).\n * Otherwise a console error might be thrown indicating a re-render loop issue.\n *\n * @param ev The DailyEvent to register.\n * @param callback A memoized callback reference to run when the event is emitted.\n */\nexport const useDailyEvent = (ev: DailyEvent, callback: EventCallback) => {\n  const { off, on } = useContext(DailyEventContext);\n  const [isBlocked, setIsBlocked] = useState(false);\n  const reassignCount = useRef<number>(0);\n\n  const eventId = useMemo(() => getUnique(), []);\n\n  useEffect(() => {\n    if (!ev || isBlocked) return;\n    /**\n     * Check if callback has been reassigned often enough without hitting the 50ms timeout.\n     */\n    if (reassignCount.current > 100000) {\n      console.error(\n        `useDailyEvent called with potentially non-memoized event callback or due to too many re-renders.\n        Memoize using useCallback to avoid re-render loop or reduce the amount of state transitions the callback depends on.\n        Passed callback for '${ev}' event is NOT registered.`,\n        callback\n      );\n      setIsBlocked(true);\n      return;\n    }\n    reassignCount.current++;\n    const timeout = setTimeout(() => {\n      reassignCount.current = 0;\n    }, 50);\n    on(ev, callback, eventId);\n    return () => {\n      clearTimeout(timeout);\n      off(ev, eventId);\n    };\n  }, [callback, ev, eventId, isBlocked, off, on]);\n};\n","import { DailyEvent, DailyEventObject } from '@daily-co/daily-js';\nimport throttle from 'lodash.throttle';\nimport { useContext, useEffect, useMemo, useRef } from 'react';\n\nimport { DailyEventContext } from '../DailyEventContext';\nimport { getUnique } from './useDailyEvent';\n\ntype EventCallback = (events: DailyEventObject[]) => void;\n\n/**\n * Sets up a throttled daily event listener using [on](https://docs.daily.co/reference/daily-js/instance-methods/on) method.\n * When this hook is unmounted the event listener is unregistered using [off](https://docs.daily.co/reference/daily-js/instance-methods/off).\n *\n * In comparison to useDailyEvent the callback passed here will be called with an array of event objects.\n *\n * @param ev The DailyEvent to register.\n * @param callback A memoized callback reference to run when throttled events are emitted.\n * @param throttleTimeout The minimum waiting time until the callback is called again. Default: 100\n */\nexport const useThrottledDailyEvent = (\n  ev: DailyEvent,\n  callback: EventCallback,\n  throttleTimeout = 100\n) => {\n  const { off, on } = useContext(DailyEventContext);\n  const eventId = useMemo(() => getUnique(), []);\n\n  const throttledEvents = useRef<DailyEventObject[]>([]);\n\n  const emitEvents = useMemo(\n    () =>\n      throttle(\n        () => {\n          if (throttledEvents.current.length === 0) return;\n          callback(throttledEvents.current);\n          throttledEvents.current = [];\n        },\n        throttleTimeout,\n        {\n          trailing: true,\n        }\n      ),\n    [callback, throttleTimeout]\n  );\n\n  useEffect(() => {\n    if (!ev) return;\n    const addEvent = (ev: DailyEventObject) => {\n      throttledEvents.current.push(ev);\n      /**\n       * A 0ms timeout allows the event loop to process additional incoming events,\n       * while the throttle is active. Otherwise every event would be delayed.\n       */\n      setTimeout(emitEvents, 0);\n    };\n    on(ev, addEvent, eventId);\n    return () => {\n      off(ev, eventId);\n    };\n  }, [emitEvents, ev, eventId, off, on]);\n};\n","import type { Paths } from '../types/paths';\nimport { ExtendedDailyParticipant } from '../DailyParticipants';\n\nexport const resolveParticipantPath = (\n  participant: ExtendedDailyParticipant,\n  path: Paths<ExtendedDailyParticipant>\n) => {\n  // ignoring the typescript here as the Paths of ExtendedDailyParticipant are not directly accessible\n  // in the ExtendedDailyParticipant object\n  // @ts-ignore\n  return path.split('.').reduce((r, k) => r?.[k], participant);\n};\n","import {\n  DailyEventObjectActiveSpeakerChange,\n  DailyEventObjectParticipant,\n  DailyEventObjectParticipants,\n  DailyParticipant,\n  DailyParticipantsObject,\n} from '@daily-co/daily-js';\nimport React, { useCallback, useEffect } from 'react';\nimport { atom, selectorFamily, useRecoilCallback } from 'recoil';\n\nimport type { Paths } from './types/paths';\nimport type { PathValue } from './types/pathValue';\nimport { useDaily } from './hooks/useDaily';\nimport { useDailyEvent } from './hooks/useDailyEvent';\nimport { useThrottledDailyEvent } from './hooks/useThrottledDailyEvent';\nimport { resolveParticipantPath } from './utils/resolveParticipantPath';\n\n/**\n * Extends DailyParticipant with convenient additional properties.\n */\nexport interface ExtendedDailyParticipant extends DailyParticipant {\n  last_active?: Date;\n}\n\ntype PropertyType = {\n  id: string;\n  property: Paths<ExtendedDailyParticipant>;\n};\n\nexport const localIdState = atom<string>({\n  key: 'local-id',\n  default: '',\n});\n\nexport const participantsState = atom<ExtendedDailyParticipant[]>({\n  key: 'participants-objects',\n  default: [],\n});\n\n/**\n * Holds each individual participant's state object.\n */\nexport const participantState = selectorFamily<\n  ExtendedDailyParticipant | null,\n  string\n>({\n  key: 'participant',\n  get:\n    (id) =>\n    ({ get }) => {\n      const participants = get(participantsState);\n      return participants.find((p) => p.session_id === id) ?? null;\n    },\n});\n\n/**\n * Holds each individual participant's property.\n */\nexport const participantPropertyState = selectorFamily<\n  PathValue<ExtendedDailyParticipant, Paths<ExtendedDailyParticipant>> | null,\n  PropertyType\n>({\n  key: 'participant-property',\n  get:\n    ({ id, property }) =>\n    ({ get }) => {\n      const participants = get(participantsState);\n      const participant = participants.find((p) => p.session_id === id) ?? null;\n\n      if (!participant) return null;\n      return resolveParticipantPath(participant, property);\n    },\n});\n\nexport const DailyParticipants: React.FC<React.PropsWithChildren<{}>> = ({\n  children,\n}) => {\n  const daily = useDaily();\n\n  useDailyEvent(\n    'active-speaker-change',\n    useRecoilCallback(\n      ({ set, snapshot }) =>\n        async (ev: DailyEventObjectActiveSpeakerChange) => {\n          const sessionId = ev.activeSpeaker.peerId;\n          let participant = await snapshot.getPromise(\n            participantState(sessionId)\n          );\n          if (!participant && daily) {\n            participant = daily.participants()[sessionId];\n          }\n          if (!participant) return;\n          set(participantsState, (prev) =>\n            [...prev].map((p) =>\n              p.session_id === sessionId\n                ? {\n                    ...p,\n                    last_active: new Date(),\n                  }\n                : p\n            )\n          );\n        },\n      [daily]\n    )\n  );\n\n  const initParticipants = useRecoilCallback(\n    ({ set }) =>\n      async (participants: DailyParticipantsObject) => {\n        set(localIdState, participants.local.session_id);\n        set(participantsState, Object.values(participants));\n      },\n    []\n  );\n  /**\n   * Initialize participants state based on daily.participants().\n   * Retries every 100ms to initialize the state, until daily is ready.\n   */\n  useEffect(() => {\n    if (!daily) return;\n    const interval = setInterval(() => {\n      const participants = daily.participants();\n      if (!('local' in participants)) return;\n      initParticipants(participants);\n      clearInterval(interval);\n    }, 100);\n    return () => {\n      clearInterval(interval);\n    };\n  }, [daily, initParticipants]);\n  const handleInitEvent = useCallback(() => {\n    if (!daily) return;\n    const participants = daily?.participants();\n    if (!participants.local) return;\n    initParticipants(participants);\n  }, [daily, initParticipants]);\n  useDailyEvent('started-camera', handleInitEvent);\n  useDailyEvent('access-state-updated', handleInitEvent);\n  useDailyEvent('joining-meeting', handleInitEvent);\n  useDailyEvent(\n    'joined-meeting',\n    useCallback(\n      (ev: DailyEventObjectParticipants) => {\n        initParticipants(ev.participants);\n      },\n      [initParticipants]\n    )\n  );\n\n  /**\n   * Add new participant to state, if not already existent.\n   */\n  useThrottledDailyEvent(\n    'participant-joined',\n    useRecoilCallback(\n      ({ set }) =>\n        async (evts: DailyEventObjectParticipant[]) => {\n          if (!evts.length) return;\n          set(participantsState, (prev) =>\n            [...prev, ...evts.map(({ participant }) => participant)].filter(\n              (participant, idx, arr) =>\n                arr.findIndex((p) => p.session_id === participant.session_id) ==\n                idx\n            )\n          );\n        },\n      []\n    )\n  );\n\n  /**\n   * Update participant in state.\n   */\n  useThrottledDailyEvent(\n    'participant-updated',\n    useRecoilCallback(\n      ({ transact_UNSTABLE }) =>\n        (evts: DailyEventObjectParticipant[]) => {\n          transact_UNSTABLE(({ set }) => {\n            evts.forEach(({ participant }) => {\n              set(participantsState, (prev) =>\n                [...prev].map((p) =>\n                  p.session_id === participant.session_id ? participant : p\n                )\n              );\n            });\n          });\n        },\n      []\n    )\n  );\n\n  /**\n   * Remove left participant from state.\n   */\n  useThrottledDailyEvent(\n    'participant-left',\n    useRecoilCallback(\n      ({ set }) =>\n        (evts: DailyEventObjectParticipant[]) => {\n          set(participantsState, (prev) =>\n            [...prev].filter(\n              (p) =>\n                !evts.some((ev) => ev.participant.session_id === p.session_id)\n            )\n          );\n        },\n      []\n    )\n  );\n\n  /**\n   * Reset stored participants, when meeting has ended.\n   */\n  useDailyEvent(\n    'left-meeting',\n    useRecoilCallback(\n      ({ reset }) =>\n        () => {\n          reset(localIdState);\n          reset(participantsState);\n        },\n      []\n    )\n  );\n\n  return <>{children}</>;\n};\n","import { DailyRoomInfo } from '@daily-co/daily-js';\nimport React from 'react';\nimport { atom, useRecoilCallback } from 'recoil';\n\nimport { useDaily } from './hooks/useDaily';\nimport { useDailyEvent } from './hooks/useDailyEvent';\n\nexport const roomState = atom<DailyRoomInfo | null>({\n  key: 'room',\n  default: null,\n});\n\nexport const DailyRoom: React.FC<React.PropsWithChildren<{}>> = ({\n  children,\n}) => {\n  const daily = useDaily();\n\n  const updateRoom = useRecoilCallback(\n    ({ set }) =>\n      async () => {\n        if (!daily || daily.meetingState() === 'left-meeting') return;\n        const room = await daily.room();\n        if (room && 'id' in room) {\n          set(roomState, room);\n        }\n        return room;\n      },\n    [daily]\n  );\n\n  useDailyEvent('access-state-updated', updateRoom);\n\n  return <>{children}</>;\n};\n","import DailyIframe, {\n  DailyCall,\n  DailyCallOptions,\n  DailyEvent,\n  DailyEventObject,\n} from '@daily-co/daily-js';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { RecoilRoot } from 'recoil';\n\nimport { DailyContext } from './DailyContext';\nimport { DailyEventContext } from './DailyEventContext';\nimport { DailyParticipants } from './DailyParticipants';\nimport { DailyRoom } from './DailyRoom';\n\ntype DailyProperties = Pick<\n  DailyCallOptions,\n  | 'audioSource'\n  | 'dailyConfig'\n  | 'receiveSettings'\n  | 'subscribeToTracksAutomatically'\n  | 'token'\n  | 'url'\n  | 'userName'\n  | 'videoSource'\n>;\n\ntype Props =\n  | DailyProperties\n  | {\n      callObject: DailyCall;\n    };\n\ntype EventsMap = Partial<Record<DailyEvent, Map<number, Function>>>;\n\nexport const DailyProvider: React.FC<React.PropsWithChildren<Props>> = ({\n  children,\n  ...props\n}) => {\n  const [callObject, setCallObject] = useState<DailyCall | null>(\n    'callObject' in props ? props.callObject : null\n  );\n  const eventsMap = useRef<EventsMap>({});\n\n  /**\n   * Update callObject reference, in case externally created instance has changed.\n   */\n  useEffect(() => {\n    if (\n      'callObject' in props &&\n      callObject &&\n      props.callObject &&\n      // TODO: Replace _callFrameId check with something \"official\".\n      // @ts-ignore\n      callObject?._callFrameId !== props?.callObject?._callFrameId\n    ) {\n      setCallObject(props.callObject);\n    }\n  }, [callObject, props]);\n\n  /**\n   * Generic event handler to loop through registered event callbacks.\n   */\n  const handleEvent = useCallback((ev: DailyEventObject) => {\n    if (!('action' in ev)) return;\n    const event = ev.action as DailyEvent;\n    for (let cb of eventsMap.current?.[event]?.values() ?? []) {\n      cb(ev);\n    }\n  }, []);\n\n  /**\n   * In case events are setup via useDailyEvent before a DailyCall instance is available,\n   * we'll register the events whenever daily is set.\n   */\n  const initEventHandlers = useCallback(\n    (daily: DailyCall) => {\n      if (!daily) return;\n      (Object.keys(eventsMap.current) as DailyEvent[]).forEach((event) => {\n        daily\n          .off(event as DailyEvent, handleEvent)\n          .on(event as DailyEvent, handleEvent);\n      });\n    },\n    [handleEvent]\n  );\n\n  useEffect(() => {\n    if (callObject) return;\n    if ('callObject' in props) {\n      setCallObject(props.callObject);\n      initEventHandlers(props.callObject);\n      return;\n    }\n    const co = DailyIframe.createCallObject(props);\n    setCallObject(co);\n    initEventHandlers(co);\n  }, [callObject, initEventHandlers, props]);\n\n  /**\n   * Registers event callback.\n   */\n  const on = useCallback(\n    (ev: DailyEvent, cb: Function, key: number) => {\n      if (!eventsMap.current[ev]) {\n        eventsMap.current[ev] = new Map();\n        if (callObject) {\n          /**\n           * Make sure only 1 event listener is registered at anytime for handleEvent.\n           * Otherwise events sent from daily-js might be handled multiple times.\n           */\n          callObject.off(ev, handleEvent).on(ev, handleEvent);\n        }\n      }\n      if (!eventsMap.current[ev]?.has(key)) {\n        eventsMap.current[ev]?.set(key, cb);\n      }\n    },\n    [callObject, handleEvent]\n  );\n\n  /**\n   * Unregisters event callback.\n   */\n  const off = useCallback(\n    (ev: DailyEvent, key: number) => {\n      eventsMap.current[ev]?.delete(key);\n      if (eventsMap.current[ev]?.size === 0) {\n        callObject?.off(ev, handleEvent);\n        delete eventsMap.current[ev];\n      }\n    },\n    [callObject, handleEvent]\n  );\n\n  return (\n    <RecoilRoot>\n      <DailyContext.Provider value={callObject}>\n        <DailyEventContext.Provider value={{ on, off }}>\n          <DailyRoom>\n            <DailyParticipants>{children}</DailyParticipants>\n          </DailyRoom>\n        </DailyEventContext.Provider>\n      </DailyContext.Provider>\n    </RecoilRoot>\n  );\n};\n","import { DailyEventObjectParticipant } from '@daily-co/daily-js';\nimport { useCallback } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { participantState } from '../DailyParticipants';\nimport { useThrottledDailyEvent } from './useThrottledDailyEvent';\n\ninterface UseParticipantArgs {\n  onParticipantLeft?(ev: DailyEventObjectParticipant): void;\n  onParticipantUpdated?(ev: DailyEventObjectParticipant): void;\n}\n\n/**\n * Returns the participant identified by the given sessionId.\n * @param sessionId – The participant's session_id or \"local\".\n */\nexport const useParticipant = (\n  sessionId: string,\n  { onParticipantLeft, onParticipantUpdated }: UseParticipantArgs = {}\n) => {\n  const participant = useRecoilValue(participantState(sessionId));\n\n  useThrottledDailyEvent(\n    'participant-updated',\n    useCallback(\n      (evts: DailyEventObjectParticipant[]) => {\n        const filteredEvts = evts.filter(\n          (ev) => ev.participant.session_id === sessionId\n        );\n        if (!filteredEvts.length) return;\n        filteredEvts.forEach((ev) => {\n          setTimeout(() => onParticipantUpdated?.(ev), 0);\n        });\n      },\n      [onParticipantUpdated, sessionId]\n    )\n  );\n\n  useThrottledDailyEvent(\n    'participant-left',\n    useCallback(\n      (evts: DailyEventObjectParticipant[]) => {\n        const filteredEvts = evts.filter(\n          (ev) => ev.participant.session_id === sessionId\n        );\n        if (!filteredEvts.length) return;\n        // Last event is sufficient to pass the information\n        const ev = evts[evts.length - 1];\n        setTimeout(() => onParticipantLeft?.(ev), 0);\n      },\n      [onParticipantLeft, sessionId]\n    )\n  );\n\n  return participant;\n};\n","import { DailyEventObjectActiveSpeakerChange } from '@daily-co/daily-js';\nimport { useEffect, useState } from 'react';\nimport { atom, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\nimport { useParticipant } from './useParticipant';\n\ninterface UseActiveParticipantArgs {\n  /**\n   * If set to true, useActiveParticipant will never return the local participant.\n   */\n  ignoreLocal?: boolean;\n  /**\n   * Optional event callback for [active-speaker-change](https://docs.daily.co/reference/daily-js/events/meeting-events#active-speaker-change) event listener.\n   */\n  onActiveSpeakerChange?(ev: DailyEventObjectActiveSpeakerChange): void;\n}\n\n/**\n * Stores the most recent peerId as reported from [active-speaker-change](https://docs.daily.co/reference/daily-js/events/meeting-events#active-speaker-change) event.\n */\nconst activeIdState = atom({\n  key: 'active-id',\n  default: '',\n});\n\n/**\n * Returns the most recent participant mentioned in an [active-speaker-change](https://docs.daily.co/reference/daily-js/events/meeting-events#active-speaker-change) event.\n */\nexport const useActiveParticipant = ({\n  ignoreLocal = false,\n  onActiveSpeakerChange,\n}: UseActiveParticipantArgs = {}) => {\n  const daily = useDaily();\n  const recentActiveId = useRecoilValue(activeIdState);\n  const [activeId, setActiveId] = useState('');\n  const activeParticipant = useParticipant(activeId);\n\n  useEffect(() => {\n    if (!daily) return;\n    const local = daily?.participants()?.local;\n    if (ignoreLocal && recentActiveId === local?.session_id) return;\n    setActiveId(recentActiveId);\n  }, [daily, ignoreLocal, recentActiveId]);\n\n  useDailyEvent(\n    'active-speaker-change',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev: DailyEventObjectActiveSpeakerChange) => {\n          set(activeIdState, ev.activeSpeaker.peerId);\n          setTimeout(() => onActiveSpeakerChange?.(ev), 0);\n        },\n      [onActiveSpeakerChange]\n    )\n  );\n\n  return activeParticipant;\n};\n","import { DailyEventObjectAppMessage } from '@daily-co/daily-js';\nimport { useCallback } from 'react';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\ntype SendAppMessage<Data = any> = (data: Data, to?: string) => void;\n\ninterface UseAppMessageArgs<Data> {\n  /**\n   * Optional event callback for [app-message](https://docs.daily.co/reference/daily-js/events/participant-events#app-message) event listener.\n   * Receives this hook's sendAppMessage as an additional argument to avoid circular dependencies.\n   */\n  onAppMessage?(\n    ev: DailyEventObjectAppMessage<Data>,\n    sendAppMessage?: SendAppMessage<Data>\n  ): void;\n}\n\n/**\n * React hook to setup [app-message](https://docs.daily.co/reference/daily-js/events/participant-events#app-message) listeners and\n * to send messages via [sendAppMessage](https://docs.daily.co/reference/daily-js/instance-methods/send-app-message).\n */\nexport const useAppMessage = <Data = any>({\n  onAppMessage,\n}: UseAppMessageArgs<Data> = {}) => {\n  const daily = useDaily();\n\n  const sendAppMessage: SendAppMessage<Data> = useCallback(\n    (data, to = '*') => {\n      if (!daily) return;\n      daily.sendAppMessage(data, to);\n    },\n    [daily]\n  );\n\n  const handleAppMessage = useCallback(\n    (ev: DailyEventObjectAppMessage<Data>) => {\n      onAppMessage?.(ev, sendAppMessage);\n    },\n    [onAppMessage, sendAppMessage]\n  );\n\n  useDailyEvent('app-message', handleAppMessage);\n\n  return sendAppMessage;\n};\n","import {\n  DailyEventObjectParticipant,\n  DailyEventObjectParticipants,\n  DailyParticipant,\n  DailyTrackState,\n} from '@daily-co/daily-js';\nimport { useEffect, useMemo } from 'react';\nimport { atomFamily, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\nimport { useThrottledDailyEvent } from './useThrottledDailyEvent';\n\ntype MediaType = keyof DailyParticipant['tracks'];\n\n// TODO: Handle optional tracks better\nconst mediaTrackState = atomFamily<DailyTrackState | undefined, string>({\n  key: 'media-track',\n  default: {\n    state: 'loading',\n    subscribed: false,\n  },\n});\n\nexport interface MediaTrackState extends DailyTrackState {\n  isOff: boolean;\n}\n\n/**\n * Returns a participant's track and state, based on the given MediaType.\n *\n * Equivalent to daily.participants()[participantId].tracks[type].\n *\n * @param participantId The participant's session_id.\n * @param type The track type. Default: \"video\"\n */\nexport const useMediaTrack = (\n  participantId: string,\n  type: MediaType = 'video'\n): MediaTrackState => {\n  const daily = useDaily();\n  const key = useMemo(() => `${participantId}-${type}`, [participantId, type]);\n  const trackState = useRecoilValue(mediaTrackState(key));\n\n  const handleNewParticipantState = useRecoilCallback(\n    ({ transact_UNSTABLE }) =>\n      (evts: DailyEventObjectParticipant[]) => {\n        const filteredEvts = evts.filter(\n          (ev) => ev.participant.session_id === participantId\n        );\n        if (!filteredEvts.length) return;\n        transact_UNSTABLE(({ reset, set }) => {\n          filteredEvts.forEach((ev) => {\n            switch (ev.action) {\n              case 'participant-joined':\n              case 'participant-updated':\n                set(mediaTrackState(key), ev.participant.tracks[type]);\n                break;\n              case 'participant-left':\n                reset(mediaTrackState(key));\n                break;\n            }\n          });\n        });\n      },\n    [key, participantId, type]\n  );\n\n  useThrottledDailyEvent('participant-joined', handleNewParticipantState);\n  useThrottledDailyEvent('participant-updated', handleNewParticipantState);\n  useThrottledDailyEvent('participant-left', handleNewParticipantState);\n\n  useDailyEvent(\n    'joined-meeting',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev: DailyEventObjectParticipants) => {\n          set(mediaTrackState(key), ev.participants.local.tracks[type]);\n        },\n      [key, type]\n    )\n  );\n\n  const setInitialState = useRecoilCallback(\n    ({ set }) =>\n      (initialState: DailyTrackState | null) => {\n        if (!initialState) return;\n        set(mediaTrackState(key), initialState);\n      },\n    [key]\n  );\n  useEffect(() => {\n    if (!daily) return;\n    const participants = daily?.participants();\n    if (!participants) return;\n    const participant = Object.values(participants).find(\n      (p) => p.session_id === participantId\n    );\n    if (!participant) return;\n    setInitialState(participant.tracks?.[type] ?? null);\n  }, [daily, participantId, setInitialState, type]);\n\n  if (!trackState)\n    return {\n      isOff: true,\n      persistentTrack: undefined,\n      state: 'off',\n      subscribed: false,\n    };\n\n  return {\n    ...trackState,\n    isOff: trackState.state === 'blocked' || trackState.state === 'off',\n  };\n};\n","import { useMediaTrack } from './useMediaTrack';\n\n/**\n * Returns a participant's audio track and state.\n * @param participantId The participant's session_id.\n */\nexport const useAudioTrack = (participantId: string) =>\n  useMediaTrack(participantId, 'audio');\n","import {\n  DailyEventObjectCameraError,\n  DailyEventObjectFatalError,\n  DailyEventObjectParticipant,\n} from '@daily-co/daily-js';\nimport { useCallback } from 'react';\nimport { atom, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\ntype GeneralState =\n  | 'pending'\n  | 'not-supported'\n  | 'granted'\n  | 'blocked'\n  | 'in-use'\n  | 'not-found';\n\ntype DeviceState = 'granted' | 'in-use';\nexport interface StatefulDevice {\n  device: MediaDeviceInfo;\n  selected: boolean;\n  state: DeviceState;\n}\n\nconst generalCameraState = atom<GeneralState>({\n  key: 'general-camera-state',\n  default: 'pending',\n});\nconst generalMicrophoneState = atom<GeneralState>({\n  key: 'general-microphone-state',\n  default: 'pending',\n});\nconst cameraDevicesState = atom<StatefulDevice[]>({\n  key: 'camera-devices',\n  default: [],\n});\nconst microphoneDevicesState = atom<StatefulDevice[]>({\n  key: 'microphone-devices',\n  default: [],\n});\nconst speakerDevicesState = atom<StatefulDevice[]>({\n  key: 'speaker-devices',\n  default: [],\n});\n\n/**\n * This hook allows access to information about the user's devices and their state.\n */\nexport const useDevices = () => {\n  const daily = useDaily();\n\n  const camState = useRecoilValue(generalCameraState);\n  const micState = useRecoilValue(generalMicrophoneState);\n  const camDevices = useRecoilValue(cameraDevicesState);\n  const micDevices = useRecoilValue(microphoneDevicesState);\n  const speakerDevices = useRecoilValue(speakerDevicesState);\n\n  /**\n   * Refreshes list of available devices using enumerateDevices.\n   * Previous device states are kept in place, otherwise states are initialized as 'granted'.\n   */\n  const refreshDevices = useRecoilCallback(\n    ({ transact_UNSTABLE }) =>\n      async () => {\n        /**\n         * Check for legacy browsers.\n         */\n        if (\n          typeof navigator?.mediaDevices?.getUserMedia === 'undefined' ||\n          typeof navigator?.mediaDevices?.enumerateDevices === 'undefined'\n        ) {\n          transact_UNSTABLE(({ set }) => {\n            set(generalCameraState, 'not-supported');\n            set(generalMicrophoneState, 'not-supported');\n          });\n          return;\n        }\n\n        if (!daily) return;\n\n        try {\n          const { devices } = await daily.enumerateDevices();\n          /**\n           * Filter out \"empty\" devices for when device access has not been granted (yet).\n           */\n          const cams = devices.filter(\n            (d) => d.kind === 'videoinput' && d.deviceId !== ''\n          );\n          const mics = devices.filter(\n            (d) => d.kind === 'audioinput' && d.deviceId !== ''\n          );\n          const speakers = devices.filter(\n            (d) => d.kind === 'audiooutput' && d.deviceId !== ''\n          );\n          const { camera, mic, speaker } = await daily.getInputDevices();\n\n          const mapDevice = (\n            device: {} | MediaDeviceInfo,\n            d: MediaDeviceInfo,\n            prevDevices: StatefulDevice[]\n          ) => ({\n            device: d,\n            selected: 'deviceId' in device && d.deviceId === device.deviceId,\n            state:\n              prevDevices.find((p) => p.device.deviceId === d.deviceId)\n                ?.state ?? 'granted',\n          });\n          const sortDeviceByLabel = (a: StatefulDevice, b: StatefulDevice) => {\n            if (a.device.deviceId === 'default') return -1;\n            if (b.device.deviceId === 'default') return 1;\n            if (a.device.label < b.device.label) return -1;\n            if (a.device.label > b.device.label) return 1;\n            return 0;\n          };\n\n          transact_UNSTABLE(({ set }) => {\n            set(cameraDevicesState, (prevCams) =>\n              cams\n                .filter(Boolean)\n                .map<StatefulDevice>((d) => mapDevice(camera, d, prevCams))\n                .sort(sortDeviceByLabel)\n            );\n            set(microphoneDevicesState, (prevMics) =>\n              mics\n                .filter(Boolean)\n                .map<StatefulDevice>((d) => mapDevice(mic, d, prevMics))\n                .sort(sortDeviceByLabel)\n            );\n            set(speakerDevicesState, (prevSpeakers) =>\n              speakers\n                .filter(Boolean)\n                .map<StatefulDevice>((d) => mapDevice(speaker, d, prevSpeakers))\n                .sort(sortDeviceByLabel)\n            );\n          });\n        } catch (e) {\n          transact_UNSTABLE(({ set }) => {\n            set(generalCameraState, 'not-supported');\n            set(generalMicrophoneState, 'not-supported');\n          });\n        }\n      },\n    [daily]\n  );\n\n  /**\n   * Updates general and specific device states, based on blocked status.\n   */\n  const updateDeviceStates = useRecoilCallback(\n    ({ set, snapshot, transact_UNSTABLE }) =>\n      async () => {\n        if (!daily) return;\n\n        const currentCamState = await snapshot.getPromise(generalCameraState);\n        const currentMicState = await snapshot.getPromise(\n          generalMicrophoneState\n        );\n\n        const { tracks } = daily.participants().local;\n\n        const awaitingCamAccess =\n          currentCamState === 'pending' && tracks.video.state === 'interrupted';\n        const awaitingMicAccess =\n          currentMicState === 'pending' && tracks.audio.state === 'interrupted';\n\n        if (tracks.audio?.blocked?.byDeviceInUse) {\n          transact_UNSTABLE(({ set }) => {\n            set(generalMicrophoneState, 'in-use');\n            set(microphoneDevicesState, (mics) =>\n              mics.map<StatefulDevice>((m) =>\n                m.selected ? { ...m, state: 'in-use' } : m\n              )\n            );\n          });\n        } else if (tracks.audio?.blocked?.byDeviceMissing) {\n          set(generalMicrophoneState, 'not-found');\n        } else if (tracks.audio?.blocked?.byPermissions) {\n          set(generalMicrophoneState, 'blocked');\n        } else if (!awaitingMicAccess) {\n          transact_UNSTABLE(({ set }) => {\n            set(generalMicrophoneState, 'granted');\n            set(microphoneDevicesState, (mics) =>\n              mics.map<StatefulDevice>((m) =>\n                m.selected ? { ...m, state: 'granted' } : m\n              )\n            );\n          });\n        }\n\n        if (tracks.video?.blocked?.byDeviceInUse) {\n          transact_UNSTABLE(({ set }) => {\n            set(generalCameraState, 'in-use');\n            set(cameraDevicesState, (cams) =>\n              cams.map<StatefulDevice>((m) =>\n                m.selected ? { ...m, state: 'in-use' } : m\n              )\n            );\n          });\n        } else if (tracks.video?.blocked?.byDeviceMissing) {\n          set(generalCameraState, 'not-found');\n        } else if (tracks.video?.blocked?.byPermissions) {\n          set(generalCameraState, 'blocked');\n        } else if (!awaitingCamAccess) {\n          transact_UNSTABLE(({ set }) => {\n            set(generalCameraState, 'granted');\n            set(cameraDevicesState, (cams) =>\n              cams.map<StatefulDevice>((m) =>\n                m.selected ? { ...m, state: 'granted' } : m\n              )\n            );\n          });\n        }\n        refreshDevices();\n      },\n    [daily, refreshDevices]\n  );\n\n  useDailyEvent(\n    'participant-updated',\n    useCallback(\n      (ev: DailyEventObjectParticipant) => {\n        if (!ev.participant.local) return;\n        updateDeviceStates();\n      },\n      [updateDeviceStates]\n    )\n  );\n\n  useDailyEvent('available-devices-updated', refreshDevices);\n\n  useDailyEvent(\n    'camera-error',\n    useRecoilCallback(\n      ({ set, transact_UNSTABLE }) =>\n        ({\n          error,\n          errorMsg: { audioOk, errorMsg, videoOk },\n        }: DailyEventObjectCameraError) => {\n          switch (error?.type) {\n            case 'cam-in-use':\n              set(generalCameraState, 'in-use');\n              break;\n            case 'mic-in-use':\n              set(generalMicrophoneState, 'in-use');\n              break;\n            case 'cam-mic-in-use':\n              transact_UNSTABLE(({ set }) => {\n                set(generalCameraState, 'in-use');\n                set(generalMicrophoneState, 'in-use');\n              });\n              break;\n            default:\n              switch (errorMsg) {\n                case 'devices error':\n                  transact_UNSTABLE(({ set }) => {\n                    if (!videoOk) set(generalCameraState, 'not-found');\n                    if (!audioOk) set(generalMicrophoneState, 'not-found');\n                  });\n                  break;\n                case 'not allowed': {\n                  transact_UNSTABLE(({ set }) => {\n                    set(generalCameraState, 'blocked');\n                    set(generalMicrophoneState, 'blocked');\n                  });\n                  updateDeviceStates();\n                  break;\n                }\n              }\n              break;\n          }\n        },\n      [updateDeviceStates]\n    )\n  );\n\n  useDailyEvent(\n    'error',\n    useRecoilCallback(\n      ({ transact_UNSTABLE }) =>\n        ({ errorMsg }: DailyEventObjectFatalError) => {\n          switch (errorMsg) {\n            case 'not allowed': {\n              transact_UNSTABLE(({ set }) => {\n                set(generalCameraState, 'blocked');\n                set(generalMicrophoneState, 'blocked');\n              });\n              updateDeviceStates();\n              break;\n            }\n          }\n        },\n      [updateDeviceStates]\n    )\n  );\n\n  /**\n   * Update all device state, when camera is started.\n   */\n  useDailyEvent(\n    'started-camera',\n    useRecoilCallback(\n      ({ transact_UNSTABLE }) =>\n        () => {\n          transact_UNSTABLE(({ set }) => {\n            set(generalCameraState, 'granted');\n            set(generalMicrophoneState, 'granted');\n          });\n          updateDeviceStates();\n        },\n      [updateDeviceStates]\n    )\n  );\n\n  /**\n   * Sets video input device to given deviceId.\n   */\n  const setCamera = useCallback(\n    async (deviceId: string) => {\n      await daily?.setInputDevicesAsync({\n        audioDeviceId: null,\n        videoDeviceId: deviceId,\n      });\n      refreshDevices();\n    },\n    [daily, refreshDevices]\n  );\n\n  /**\n   * Sets audio input device to given deviceId.\n   */\n  const setMicrophone = useCallback(\n    async (deviceId: string) => {\n      await daily?.setInputDevicesAsync({\n        audioDeviceId: deviceId,\n        videoDeviceId: null,\n      });\n      refreshDevices();\n    },\n    [daily, refreshDevices]\n  );\n\n  /**\n   * Sets audio output device to given deviceId.\n   */\n  const setSpeaker = useCallback(\n    async (deviceId: string) => {\n      await daily?.setOutputDeviceAsync({\n        outputDeviceId: deviceId,\n      });\n      refreshDevices();\n    },\n    [daily, refreshDevices]\n  );\n\n  return {\n    /**\n     * A list of the user's camera (videoinput) devices. See [MediaDeviceInfo](https://developer.mozilla.org/en-US/docs/Web/API/MediaDeviceInfo) for more info.\n     */\n    cameras: camDevices,\n    /**\n     * The general state for camera access.\n     */\n    camState,\n    /**\n     * Indicates that there's an issue with camera devices.\n     */\n    hasCamError: ['blocked', 'in-use', 'not-found'].includes(camState),\n    /**\n     * Indicates that there's an issue with microphone devices.\n     */\n    hasMicError: ['blocked', 'in-use', 'not-found'].includes(micState),\n    /**\n     * A list of the user's microphone (audioinput) devices. See [MediaDeviceInfo](https://developer.mozilla.org/en-US/docs/Web/API/MediaDeviceInfo) for more info.\n     */\n    microphones: micDevices,\n    /**\n     * The general state for microphone access.\n     */\n    micState,\n    /**\n     * Refreshes the list of devices using [enumerateDevices](https://docs.daily.co/reference/daily-js/instance-methods/enumerate-devices).\n     */\n    refreshDevices,\n    /**\n     * Allows to switch to the camera with the specified deviceId. Calls [setInputDevicesAsync](https://docs.daily.co/reference/daily-js/instance-methods/set-input-devices-async) internally.\n     */\n    setCamera,\n    /**\n     * Allows to switch to the microphone with the specified deviceId. Calls [setInputDevicesAsync](https://docs.daily.co/reference/daily-js/instance-methods/set-input-devices-async) internally.\n     */\n    setMicrophone,\n    /**\n     * Allows to switch to the speaker with the specified deviceId. Calls [setOutputDevice](https://docs.daily.co/reference/daily-js/instance-methods/set-output-device) internally.\n     */\n    setSpeaker,\n    /**\n     * A list of the user's speaker (audiooutput) devices. See [MediaDeviceInfo](https://developer.mozilla.org/en-US/docs/Web/API/MediaDeviceInfo) for more info.\n     */\n    speakers: speakerDevices,\n  };\n};\n","import {\n  DailyEventObjectInputSettingsUpdated,\n  DailyEventObjectNonFatalError,\n  DailyInputSettings,\n} from '@daily-co/daily-js';\nimport { useCallback, useEffect } from 'react';\nimport { atom, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\ninterface UseInputSettingsArgs {\n  onError?(ev: DailyEventObjectNonFatalError): void;\n  onInputSettingsUpdated?(ev: DailyEventObjectInputSettingsUpdated): void;\n}\n\nconst inputSettingsState = atom<DailyInputSettings | null>({\n  key: 'input-settings',\n  default: null,\n});\nconst errorState = atom<string | null>({\n  key: 'input-settings-error',\n  default: null,\n});\n\nexport const useInputSettings = ({\n  onError,\n  onInputSettingsUpdated,\n}: UseInputSettingsArgs = {}) => {\n  const inputSettings = useRecoilValue(inputSettingsState);\n  const errorMsg = useRecoilValue(errorState);\n  const daily = useDaily();\n\n  const updateInputSettingsState = useRecoilCallback(\n    ({ set }) =>\n      (inputSettings: DailyInputSettings) => {\n        set(inputSettingsState, inputSettings);\n      },\n    []\n  );\n\n  useEffect(() => {\n    if (!daily) return;\n    daily.getInputSettings().then(updateInputSettingsState);\n  }, [daily, updateInputSettingsState]);\n\n  /**\n   * Handle 'input-settings-updated' events.\n   */\n  useDailyEvent(\n    'input-settings-updated',\n    useCallback(\n      (ev: DailyEventObjectInputSettingsUpdated) => {\n        updateInputSettingsState(ev.inputSettings);\n        setTimeout(() => onInputSettingsUpdated?.(ev), 0);\n      },\n      [onInputSettingsUpdated, updateInputSettingsState]\n    )\n  );\n\n  /**\n   * Handle nonfatal errors of type 'input-settings-error'.\n   */\n  useDailyEvent(\n    'nonfatal-error',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev: DailyEventObjectNonFatalError) => {\n          if (ev.type !== 'input-settings-error') return;\n          set(errorState, ev.errorMsg);\n          setTimeout(() => onError?.(ev), 0);\n        },\n      [onError]\n    )\n  );\n\n  /**\n   * Calls daily.updateInputSettings internally.\n   */\n  const updateInputSettings = useCallback(\n    (inputSettings: DailyInputSettings) => {\n      daily?.updateInputSettings(inputSettings);\n    },\n    [daily]\n  );\n\n  return {\n    errorMsg,\n    inputSettings,\n    updateInputSettings,\n  };\n};\n","import {\n  DailyEventObject,\n  DailyEventObjectGenericError,\n  DailyEventObjectLiveStreamingStarted,\n  DailyLiveStreamingOptions,\n  DailyStreamingLayoutConfig,\n} from '@daily-co/daily-js';\nimport { useCallback } from 'react';\nimport { atom, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\ninterface UseLiveStreamingArgs {\n  onLiveStreamingStarted?(ev: DailyEventObjectLiveStreamingStarted): void;\n  onLiveStreamingStopped?(ev: DailyEventObject): void;\n  onLiveStreamingError?(ev: DailyEventObjectGenericError): void;\n}\n\ninterface LiveStreamingState {\n  errorMsg?: string;\n  isLiveStreaming: boolean;\n  layout?: DailyStreamingLayoutConfig;\n}\n\nconst liveStreamingState = atom<LiveStreamingState>({\n  key: 'live-streaming',\n  default: {\n    errorMsg: undefined,\n    isLiveStreaming: false,\n    layout: undefined,\n  },\n});\n\n/**\n * This hook allows to setup [live streaming events](https://docs.daily.co/reference/daily-js/events/live-streaming-events),\n * as well as starting, stopping and updating live streams.\n *\n * Returns the current live streaming state, incl. the current layout and potential errorMsg.\n */\nexport const useLiveStreaming = ({\n  onLiveStreamingError,\n  onLiveStreamingStarted,\n  onLiveStreamingStopped,\n}: UseLiveStreamingArgs = {}) => {\n  const daily = useDaily();\n  const state = useRecoilValue(liveStreamingState);\n\n  useDailyEvent(\n    'live-streaming-started',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev: DailyEventObjectLiveStreamingStarted) => {\n          set(liveStreamingState, {\n            isLiveStreaming: true,\n            layout: ev?.layout,\n          });\n          setTimeout(() => onLiveStreamingStarted?.(ev), 0);\n        },\n      [onLiveStreamingStarted]\n    )\n  );\n\n  useDailyEvent(\n    'live-streaming-stopped',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev: DailyEventObject) => {\n          set(liveStreamingState, (prevState) => ({\n            ...prevState,\n            isLiveStreaming: false,\n            layout: undefined,\n          }));\n          setTimeout(() => onLiveStreamingStopped?.(ev), 0);\n        },\n      [onLiveStreamingStopped]\n    )\n  );\n\n  useDailyEvent(\n    'live-streaming-error',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev: DailyEventObjectGenericError) => {\n          set(liveStreamingState, (prevState) => ({\n            ...prevState,\n            errorMsg: ev.errorMsg,\n          }));\n          setTimeout(() => onLiveStreamingError?.(ev), 0);\n        },\n      [onLiveStreamingError]\n    )\n  );\n\n  const startLiveStreaming = useCallback(\n    (options: DailyLiveStreamingOptions) => {\n      if (!daily) return;\n      daily.startLiveStreaming(options);\n    },\n    [daily]\n  );\n\n  const stopLiveStreaming = useCallback(() => {\n    if (!daily) return;\n    daily.stopLiveStreaming();\n  }, [daily]);\n\n  const updateLiveStreaming = useCallback(\n    ({ layout }: { layout: DailyStreamingLayoutConfig | undefined }) => {\n      if (!daily) return;\n      daily.updateLiveStreaming({\n        layout,\n      });\n    },\n    [daily]\n  );\n\n  return {\n    ...state,\n    startLiveStreaming,\n    stopLiveStreaming,\n    updateLiveStreaming,\n  };\n};\n","import { useRecoilValue } from 'recoil';\n\nimport { localIdState } from '../DailyParticipants';\nimport { useParticipant } from './useParticipant';\n\n/**\n * Returns the [participants() object](https://docs.daily.co/reference/daily-js/instance-methods/participants) for the local user.\n */\nexport const useLocalParticipant = (): ReturnType<typeof useParticipant> => {\n  const localId = useRecoilValue(localIdState);\n  return useParticipant(localId);\n};\n","import { useRecoilValue } from 'recoil';\n\nimport { localIdState } from '../DailyParticipants';\n\n/**\n * Returns the local participant's session_id or null,\n * if the local participant doesn't exist.\n */\nexport const useLocalSessionId = () => {\n  return useRecoilValue(localIdState) || null;\n};\n","import {\n  DailyEventObjectNetworkConnectionEvent,\n  DailyEventObjectNetworkQualityEvent,\n  DailyNetworkStats,\n  DailyNetworkTopology,\n} from '@daily-co/daily-js';\nimport { useCallback } from 'react';\nimport { atom, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\ninterface UseNetworkArgs {\n  onNetworkConnection?(ev: DailyEventObjectNetworkConnectionEvent): void;\n  onNetworkQualityChange?(ev: DailyEventObjectNetworkQualityEvent): void;\n}\n\nconst topologyState = atom<DailyNetworkTopology>({\n  key: 'topology',\n  default: 'peer',\n});\nconst networkQualityState = atom<DailyNetworkStats['quality']>({\n  key: 'networkQuality',\n  default: 100,\n});\nconst networkThresholdState = atom<DailyNetworkStats['threshold']>({\n  key: 'networkThreshold',\n  default: 'good',\n});\n\n/**\n * Returns current information about network quality and topology.\n * Allows to setup event listeners for daily's [network events](https://docs.daily.co/reference/daily-js/events/network-events).\n */\nexport const useNetwork = ({\n  onNetworkConnection,\n  onNetworkQualityChange,\n}: UseNetworkArgs = {}) => {\n  const daily = useDaily();\n\n  const topology = useRecoilValue(topologyState);\n  const quality = useRecoilValue(networkQualityState);\n  const threshold = useRecoilValue(networkThresholdState);\n\n  const handleNetworkConnection = useRecoilCallback(\n    ({ transact_UNSTABLE }) =>\n      (ev: DailyEventObjectNetworkConnectionEvent) => {\n        transact_UNSTABLE(({ set }) => {\n          switch (ev.event) {\n            case 'connected':\n              if (ev.type === 'peer-to-peer') set(topologyState, 'peer');\n              if (ev.type === 'sfu') set(topologyState, 'sfu');\n              break;\n          }\n        });\n        setTimeout(() => onNetworkConnection?.(ev), 0);\n      },\n    [onNetworkConnection]\n  );\n\n  const handleNetworkQualityChange = useRecoilCallback(\n    ({ transact_UNSTABLE }) =>\n      (ev: DailyEventObjectNetworkQualityEvent) => {\n        transact_UNSTABLE(({ set }) => {\n          set(networkQualityState, (prevQuality) =>\n            prevQuality !== ev.quality ? ev.quality : prevQuality\n          );\n          set(networkThresholdState, (prevThreshold) =>\n            prevThreshold !== ev.threshold ? ev.threshold : prevThreshold\n          );\n        });\n        setTimeout(() => onNetworkQualityChange?.(ev), 0);\n      },\n    [onNetworkQualityChange]\n  );\n\n  useDailyEvent('network-connection', handleNetworkConnection);\n  useDailyEvent('network-quality-change', handleNetworkQualityChange);\n\n  const getStats = useCallback(async () => {\n    const newStats = await daily?.getNetworkStats();\n    return newStats?.stats;\n  }, [daily]);\n\n  return {\n    getStats,\n    quality,\n    threshold,\n    topology,\n  };\n};\n","import {\n  DailyEventObjectActiveSpeakerChange,\n  DailyEventObjectParticipant,\n  DailyParticipant,\n} from '@daily-co/daily-js';\nimport { useCallback, useMemo } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { participantsState } from '../DailyParticipants';\nimport { useThrottledDailyEvent } from './useThrottledDailyEvent';\n\ntype FilterParticipantsFunction = (\n  p: DailyParticipant,\n  index: number,\n  arr: DailyParticipant[]\n) => boolean;\ntype FilterParticipants =\n  | 'local'\n  | 'remote'\n  | 'owner'\n  | 'record'\n  | 'screen'\n  | FilterParticipantsFunction;\n\ntype SortParticipantsFunction = (\n  a: DailyParticipant,\n  b: DailyParticipant\n) => 1 | -1 | 0;\ntype SortParticipants =\n  | 'joined_at'\n  | 'session_id'\n  | 'user_id'\n  | 'user_name'\n  | SortParticipantsFunction;\n\nconst defaultFilter: FilterParticipants = Boolean;\nconst defaultSort: SortParticipants = () => 0;\n\ninterface UseParticipantIdsArgs {\n  filter?: FilterParticipants;\n  onActiveSpeakerChange?(ev: DailyEventObjectActiveSpeakerChange): void;\n  onParticipantJoined?(ev: DailyEventObjectParticipant): void;\n  onParticipantLeft?(ev: DailyEventObjectParticipant): void;\n  onParticipantUpdated?(ev: DailyEventObjectParticipant): void;\n  sort?: SortParticipants;\n}\n\n/**\n * Returns a list of participant ids (= session_id).\n * The list can optionally be filtered and sorted, using the filter and sort options.\n */\nexport const useParticipantIds = (\n  {\n    filter = defaultFilter,\n    onActiveSpeakerChange,\n    onParticipantJoined,\n    onParticipantLeft,\n    onParticipantUpdated,\n    sort = defaultSort,\n  }: UseParticipantIdsArgs = {\n    filter: defaultFilter,\n    sort: defaultSort,\n  }\n) => {\n  const allParticipants = useRecoilValue(participantsState);\n\n  const sortedIds = useMemo(() => {\n    let filterFn = defaultFilter;\n    switch (filter) {\n      case 'local':\n        filterFn = (p) => p.local;\n        break;\n      case 'owner':\n        filterFn = (p) => p.owner;\n        break;\n      case 'record':\n        filterFn = (p) => p.record;\n        break;\n      case 'remote':\n        filterFn = (p) => !p.local;\n        break;\n      case 'screen':\n        filterFn = (p) => p.screen;\n        break;\n      default:\n        filterFn = filter;\n    }\n    let sortFn: SortParticipantsFunction;\n    switch (sort) {\n      case 'joined_at':\n      case 'session_id':\n      case 'user_id':\n      case 'user_name':\n        sortFn = (a, b) => {\n          if (a[sort] < b[sort]) return -1;\n          if (a[sort] > b[sort]) return 1;\n          return 0;\n        };\n        break;\n      default:\n        sortFn = sort;\n        break;\n    }\n    return allParticipants\n      .filter(filterFn)\n      .sort(sortFn)\n      .map((p) => p.session_id)\n      .filter(Boolean);\n  }, [allParticipants, filter, sort]);\n\n  useThrottledDailyEvent(\n    'participant-joined',\n    useCallback(\n      (evts: DailyEventObjectParticipant[]) => {\n        if (!evts.length) return;\n        evts.forEach((ev) => setTimeout(() => onParticipantJoined?.(ev), 0));\n      },\n      [onParticipantJoined]\n    )\n  );\n\n  useThrottledDailyEvent(\n    'participant-updated',\n    useCallback(\n      (evts: DailyEventObjectParticipant[]) => {\n        if (!evts.length) return;\n        evts.forEach((ev) => setTimeout(() => onParticipantUpdated?.(ev), 0));\n      },\n      [onParticipantUpdated]\n    )\n  );\n\n  useThrottledDailyEvent(\n    'active-speaker-change',\n    useCallback(\n      async (evts: DailyEventObjectActiveSpeakerChange[]) => {\n        if (!evts.length) return;\n        evts.forEach((ev) => setTimeout(() => onActiveSpeakerChange?.(ev), 0));\n      },\n      [onActiveSpeakerChange]\n    )\n  );\n\n  useThrottledDailyEvent(\n    'participant-left',\n    useCallback(\n      (evts: DailyEventObjectParticipant[]) => {\n        if (!evts.length) return;\n        evts.forEach((ev) => setTimeout(() => onParticipantLeft?.(ev), 0));\n      },\n      [onParticipantLeft]\n    )\n  );\n\n  return sortedIds;\n};\n","import { useRecoilValue } from 'recoil';\n\nimport type { Paths } from '../types/paths';\nimport {\n  ExtendedDailyParticipant,\n  participantPropertyState,\n} from '../DailyParticipants';\n\n/**\n * Returns a participant's property that you subscribe to.\n * @param participantId The participant's session_id.\n * @param propertyPath the participant property that you want to subscribe to.\n */\nexport const useParticipantProperty = (\n  participantId: string,\n  propertyPath: Paths<ExtendedDailyParticipant>\n) => {\n  return useRecoilValue(\n    participantPropertyState({ id: participantId, property: propertyPath })\n  );\n};\n","import {\n  DailyEventObjectReceiveSettingsUpdated,\n  DailyReceiveSettings,\n  DailySingleParticipantReceiveSettings,\n} from '@daily-co/daily-js';\nimport { useCallback } from 'react';\nimport { atomFamily, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\nconst participantReceiveSettingsState = atomFamily<\n  DailySingleParticipantReceiveSettings,\n  string\n>({\n  key: 'participant-receive-settings',\n  default: {},\n});\n\ninterface UseReceiveSettingsArgs {\n  id?: string;\n  onReceiveSettingsUpdated?(ev: DailyEventObjectReceiveSettingsUpdated): void;\n}\n\n/**\n * Allows to read and set receiveSettings.\n * In case receiveSettings for participant specified by id are empty, not set or 'inherit',\n * base receiveSettings will be returned.\n * In case meeting is not in joined state, calls to updateReceiveSettings will be silently ignored.\n */\nexport const useReceiveSettings = ({\n  id = 'base',\n  onReceiveSettingsUpdated,\n}: UseReceiveSettingsArgs = {}) => {\n  const baseSettings = useRecoilValue(participantReceiveSettingsState('base'));\n  const receiveSettings = useRecoilValue(participantReceiveSettingsState(id));\n  const daily = useDaily();\n\n  useDailyEvent(\n    'receive-settings-updated',\n    useRecoilCallback(\n      ({ transact_UNSTABLE }) =>\n        (ev: DailyEventObjectReceiveSettingsUpdated) => {\n          transact_UNSTABLE(({ reset, set }) => {\n            const { ...ids } = ev.receiveSettings;\n            for (let [id, settings] of Object.entries(ids)) {\n              set(participantReceiveSettingsState(id), settings);\n            }\n            if (!(id in ids)) {\n              reset(participantReceiveSettingsState(id));\n            }\n          });\n          setTimeout(() => onReceiveSettingsUpdated?.(ev), 0);\n        },\n      [id, onReceiveSettingsUpdated]\n    )\n  );\n\n  const updateReceiveSettings = useCallback(\n    (receiveSettings: DailyReceiveSettings) => {\n      if (!(daily && daily.meetingState() === 'joined-meeting')) {\n        return;\n      }\n      daily?.updateReceiveSettings?.(receiveSettings);\n    },\n    [daily]\n  );\n\n  return {\n    receiveSettings:\n      id === 'base' || Object.keys(receiveSettings).length === 0\n        ? baseSettings\n        : receiveSettings,\n    updateReceiveSettings,\n  };\n};\n","import {\n  DailyEventObjectNoPayload,\n  DailyEventObjectRecordingData,\n  DailyEventObjectRecordingStarted,\n  DailyStreamingLayoutConfig,\n  DailyStreamingOptions,\n} from '@daily-co/daily-js';\nimport { useCallback, useEffect } from 'react';\nimport {\n  atom,\n  useRecoilCallback,\n  useRecoilValue,\n  useSetRecoilState,\n} from 'recoil';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\nimport { useLocalSessionId } from './useLocalSessionId';\nimport { useParticipantIds } from './useParticipantIds';\n\ninterface UseRecordingArgs {\n  onRecordingData?(ev: DailyEventObjectRecordingData): void;\n  onRecordingError?(ev: DailyEventObjectNoPayload): void;\n  onRecordingStarted?(ev: DailyEventObjectRecordingStarted): void;\n  onRecordingStopped?(ev: DailyEventObjectNoPayload): void;\n}\n\ninterface RecordingState {\n  /**\n   * Determines wether an error occurred during the last recording attempt.\n   */\n  error?: boolean;\n  /**\n   * Determines wether the local participant is being recorded, based on the recording settings.\n   */\n  isLocalParticipantRecorded: boolean;\n  /**\n   * Determines wether a recording is currently running or not.\n   */\n  isRecording: boolean;\n  /**\n   * Contains the last applied cloud recording layout config.\n   */\n  layout?: DailyStreamingLayoutConfig;\n  /**\n   * Determines wether the recording is running locally.\n   * See [enable_recording](https://docs.daily.co/reference/rest-api/rooms/config#enable_recording).\n   */\n  local?: boolean;\n  /**\n   * Contains the recording id.\n   */\n  recordingId?: string;\n  /**\n   * Contains the date when the 'recording-started' event was received.\n   * This doesn't necessarily match the date the recording was actually started.\n   */\n  recordingStartedDate?: Date;\n  /**\n   * Contains the session_id of the participant who started the recording.\n   */\n  startedBy?: string;\n  /**\n   * Contains the recording type.\n   * See [enable_recording](https://docs.daily.co/reference/rest-api/rooms/config#enable_recording).\n   */\n  type?: string;\n}\n\nconst recordingState = atom<RecordingState>({\n  key: 'recording',\n  default: {\n    isLocalParticipantRecorded: false,\n    isRecording: false,\n  },\n});\n\nexport const useRecording = ({\n  onRecordingData,\n  onRecordingError,\n  onRecordingStarted,\n  onRecordingStopped,\n}: UseRecordingArgs = {}) => {\n  const daily = useDaily();\n  const state = useRecoilValue(recordingState);\n  const setState = useSetRecoilState(recordingState);\n\n  const localSessionId = useLocalSessionId();\n\n  const recordingParticipantIds = useParticipantIds({\n    filter: 'record',\n  });\n  /**\n   * Update recording state, whenever amount of recording participants changes.\n   */\n  useEffect(() => {\n    const hasRecordingParticipants = recordingParticipantIds.length > 0;\n    const isLocalParticipantRecording = recordingParticipantIds.includes(\n      localSessionId ?? 'local'\n    );\n    setState((s) => ({\n      ...s,\n      // In case type is local or not set, determine based on recording participants\n      isLocalParticipantRecorded:\n        s?.type === 'local' || !s?.type\n          ? hasRecordingParticipants\n          : s.isLocalParticipantRecorded,\n      isRecording:\n        s?.type === 'local' || !s?.type\n          ? hasRecordingParticipants\n          : s.isRecording,\n      local:\n        (s?.type === 'local' || !s?.type) && hasRecordingParticipants\n          ? isLocalParticipantRecording\n          : s?.local,\n      /**\n       * Set type in case recording participants are detected.\n       * We only set `record` on participants, when recording type is 'local'.\n       */\n      type: hasRecordingParticipants ? 'local' : s?.type,\n    }));\n  }, [localSessionId, recordingParticipantIds, setState]);\n\n  useDailyEvent(\n    'recording-started',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev: DailyEventObjectRecordingStarted) => {\n          let isLocalParticipantRecorded = true;\n          switch (ev.type) {\n            case 'cloud-beta':\n            case 'cloud': {\n              if (\n                localSessionId &&\n                ev.layout?.preset === 'single-participant' &&\n                ev.layout.session_id !== localSessionId\n              ) {\n                isLocalParticipantRecorded = false;\n              }\n              break;\n            }\n          }\n          set(recordingState, {\n            error: false,\n            isLocalParticipantRecorded,\n            isRecording: true,\n            layout: ev?.layout,\n            local: ev?.local,\n            recordingId: ev?.recordingId,\n            recordingStartedDate: new Date(),\n            startedBy: ev?.startedBy,\n            type: ev?.type,\n          });\n          setTimeout(() => onRecordingStarted?.(ev), 0);\n        },\n      [localSessionId, onRecordingStarted]\n    )\n  );\n  useDailyEvent(\n    'recording-stopped',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev: DailyEventObjectNoPayload) => {\n          set(recordingState, (prevState) => ({\n            ...prevState,\n            isLocalParticipantRecorded: false,\n            isRecording: false,\n          }));\n          setTimeout(() => onRecordingStopped?.(ev), 0);\n        },\n      [onRecordingStopped]\n    )\n  );\n  useDailyEvent(\n    'recording-error',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev: DailyEventObjectNoPayload) => {\n          set(recordingState, (prevState) => ({\n            ...prevState,\n            error: true,\n            isLocalParticipantRecorded: false,\n            isRecording: false,\n          }));\n          setTimeout(() => onRecordingError?.(ev), 0);\n        },\n      [onRecordingError]\n    )\n  );\n  useDailyEvent(\n    'recording-data',\n    useCallback(\n      (ev: DailyEventObjectRecordingData) => {\n        onRecordingData?.(ev);\n      },\n      [onRecordingData]\n    )\n  );\n\n  /**\n   * Starts the recording with the given optional options.\n   */\n  const startRecording = useCallback(\n    (options?: DailyStreamingOptions) => {\n      if (!daily) return;\n      daily.startRecording(options);\n    },\n    [daily]\n  );\n\n  /**\n   * Stops a recording.\n   */\n  const stopRecording = useCallback(() => {\n    if (!daily) return;\n    daily.stopRecording();\n  }, [daily]);\n\n  /**\n   * Updates a running recording's layout configuration.\n   */\n  const updateRecording = useCallback(\n    (options: { layout?: DailyStreamingLayoutConfig | undefined }) => {\n      if (!daily) return;\n      daily.updateRecording(options);\n    },\n    [daily]\n  );\n\n  return {\n    ...state,\n    startRecording,\n    stopRecording,\n    updateRecording,\n  };\n};\n","import { DailyRoomInfo } from '@daily-co/daily-js';\nimport { useRecoilValue } from 'recoil';\n\nimport { roomState } from '../DailyRoom';\n\n/**\n * Stateful hook to work with room, domain and token configuration for a daily room.\n * Includes room default values.\n */\nexport const useRoom = (): DailyRoomInfo | null => {\n  const room = useRecoilValue(roomState);\n  return room;\n};\n","import { useMediaTrack } from './useMediaTrack';\n\n/**\n * Returns a participant's screenAudio track and state.\n * @param participantId The participant's session_id.\n */\nexport const useScreenAudioTrack = (participantId: string) =>\n  useMediaTrack(participantId, 'screenAudio');\n","import { DailyScreenCaptureOptions, DailyTrackState } from '@daily-co/daily-js';\nimport { useCallback, useMemo } from 'react';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\nimport { useParticipantIds } from './useParticipantIds';\n\nexport interface ScreenShare {\n  local: boolean;\n  screenAudio: DailyTrackState;\n  screenVideo: DailyTrackState;\n  screenId: string;\n  session_id: string;\n}\n\ninterface UseScreenShareArgs {\n  onLocalScreenShareStarted?(): void;\n  onLocalScreenShareStopped?(): void;\n}\n\n/**\n * Allows access to information about shared screens, and methods to start or stop a local screen share.\n */\nexport const useScreenShare = ({\n  onLocalScreenShareStarted,\n  onLocalScreenShareStopped,\n}: UseScreenShareArgs = {}) => {\n  const daily = useDaily();\n\n  const startScreenShare = useCallback(\n    (captureOptions?: DailyScreenCaptureOptions) => {\n      daily?.startScreenShare(captureOptions);\n    },\n    [daily]\n  );\n\n  const stopScreenShare = useCallback(() => {\n    daily?.stopScreenShare();\n  }, [daily]);\n\n  useDailyEvent(\n    'local-screen-share-started',\n    useCallback(\n      () => onLocalScreenShareStarted?.(),\n      [onLocalScreenShareStarted]\n    )\n  );\n  useDailyEvent(\n    'local-screen-share-stopped',\n    useCallback(\n      () => onLocalScreenShareStopped?.(),\n      [onLocalScreenShareStopped]\n    )\n  );\n\n  const screenIds = useParticipantIds({\n    filter: 'screen',\n  });\n  const screens = useMemo(\n    () =>\n      screenIds\n        .map((id) => {\n          const participants = Object.values(daily?.participants?.() ?? {});\n          const p = participants.find((p) => p.session_id === id);\n          if (!p) return;\n          return {\n            local: p.local,\n            screenAudio: p.tracks.screenAudio,\n            screenVideo: p.tracks.screenVideo,\n            screenId: `${id}-screen`,\n            session_id: id,\n          };\n        })\n        /**\n         * We'll need a type predicate to fully convince TypeScript that this array\n         * can't contain undefined. Find a good quick intro about type predicates at:\n         * https://fettblog.eu/typescript-type-predicates/\n         */\n        .filter((p): p is ScreenShare => !!p),\n    [daily, screenIds]\n  );\n\n  return {\n    isSharingScreen: screens.some((s) => s.local),\n    screens,\n    startScreenShare,\n    stopScreenShare,\n  };\n};\n","import { useMediaTrack } from './useMediaTrack';\n\n/**\n * Returns a participant's screenVideo track and state.\n * @param participantId The participant's session_id.\n */\nexport const useScreenVideoTrack = (participantId: string) =>\n  useMediaTrack(participantId, 'screenVideo');\n","import { useMediaTrack } from './useMediaTrack';\n\n/**\n * Returns a participant's video track and state.\n * @param participantId The participant's session_id.\n */\nexport const useVideoTrack = (participantId: string) =>\n  useMediaTrack(participantId, 'video');\n","import {\n  DailyEventObjectWaitingParticipant,\n  DailyWaitingParticipant,\n} from '@daily-co/daily-js';\nimport { useCallback } from 'react';\nimport {\n  atom,\n  atomFamily,\n  selector,\n  useRecoilCallback,\n  useRecoilValue,\n} from 'recoil';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\ninterface UseWaitingParticipantsArgs {\n  onWaitingParticipantAdded?(ev: DailyEventObjectWaitingParticipant): void;\n  onWaitingParticipantUpdated?(ev: DailyEventObjectWaitingParticipant): void;\n  onWaitingParticipantRemoved?(ev: DailyEventObjectWaitingParticipant): void;\n}\n\nconst waitingParticipantsState = atom<string[]>({\n  key: 'waiting-participants',\n  default: [],\n});\n\nexport const waitingParticipantState = atomFamily<\n  DailyWaitingParticipant,\n  string\n>({\n  key: 'waiting-participant',\n  default: {\n    awaitingAccess: {\n      level: 'full',\n    },\n    id: '',\n    name: '',\n  },\n});\n\nexport const allWaitingParticipantsSelector = selector({\n  key: 'waitingParticipantsSelector',\n  get: ({ get }) => {\n    const ids = get(waitingParticipantsState);\n    return ids.map((id) => get(waitingParticipantState(id)));\n  },\n});\n\n/**\n * Hook to access and manage waiting participants.\n */\nexport const useWaitingParticipants = ({\n  onWaitingParticipantAdded,\n  onWaitingParticipantRemoved,\n  onWaitingParticipantUpdated,\n}: UseWaitingParticipantsArgs = {}) => {\n  const daily = useDaily();\n\n  const waitingParticipants = useRecoilValue(allWaitingParticipantsSelector);\n\n  const handleAdded = useRecoilCallback(\n    ({ transact_UNSTABLE }) =>\n      (ev: DailyEventObjectWaitingParticipant) => {\n        transact_UNSTABLE(({ set }) => {\n          set(waitingParticipantsState, (wps) => {\n            if (!wps.includes(ev.participant.id)) {\n              return [...wps, ev.participant.id];\n            }\n            return wps;\n          });\n          set(waitingParticipantState(ev.participant.id), ev.participant);\n        });\n        setTimeout(() => onWaitingParticipantAdded?.(ev), 0);\n      },\n    [onWaitingParticipantAdded]\n  );\n\n  const handleRemoved = useRecoilCallback(\n    ({ transact_UNSTABLE }) =>\n      (ev: DailyEventObjectWaitingParticipant) => {\n        transact_UNSTABLE(({ reset, set }) => {\n          set(waitingParticipantsState, (wps) =>\n            wps.filter((wp) => wp !== ev.participant.id)\n          );\n          reset(waitingParticipantState(ev.participant.id));\n        });\n        setTimeout(() => onWaitingParticipantRemoved?.(ev), 0);\n      },\n    [onWaitingParticipantRemoved]\n  );\n\n  const handleUpdated = useRecoilCallback(\n    ({ set }) =>\n      (ev: DailyEventObjectWaitingParticipant) => {\n        set(waitingParticipantState(ev.participant.id), ev.participant);\n        setTimeout(() => onWaitingParticipantUpdated?.(ev), 0);\n      },\n    [onWaitingParticipantUpdated]\n  );\n\n  useDailyEvent('waiting-participant-added', handleAdded);\n  useDailyEvent('waiting-participant-removed', handleRemoved);\n  useDailyEvent('waiting-participant-updated', handleUpdated);\n\n  const updateWaitingParticipantAccess = useCallback(\n    (id: '*' | string, grantRequestedAccess: boolean) => {\n      if (id === '*') {\n        daily?.updateWaitingParticipants({\n          '*': {\n            grantRequestedAccess,\n          },\n        });\n        return;\n      }\n      daily?.updateWaitingParticipant(id, {\n        grantRequestedAccess,\n      });\n    },\n    [daily]\n  );\n\n  const grantAccess = useCallback(\n    (id: '*' | string) => {\n      updateWaitingParticipantAccess(id, true);\n    },\n    [updateWaitingParticipantAccess]\n  );\n\n  const denyAccess = useCallback(\n    (id: '*' | string) => {\n      updateWaitingParticipantAccess(id, false);\n    },\n    [updateWaitingParticipantAccess]\n  );\n\n  return {\n    waitingParticipants,\n    grantAccess,\n    denyAccess,\n  };\n};\n"],"names":["DailyContext","createContext","DailyEventContext","on","off","useDaily","daily","useContext","uniqueCounter","getUnique","useDailyEvent","ev","callback","useState","isBlocked","setIsBlocked","reassignCount","useRef","eventId","useMemo","useEffect","current","console","error","timeout","setTimeout","clearTimeout","useThrottledDailyEvent","throttleTimeout","throttledEvents","emitEvents","throttle","length","trailing","addEvent","push","resolveParticipantPath","participant","path","split","reduce","r","k","localIdState","atom","key","participantsState","participantState","selectorFamily","get","id","participants","find","p","session_id","participantPropertyState","property","DailyParticipants","children","useRecoilCallback","set","snapshot","sessionId","activeSpeaker","peerId","getPromise","prev","map","last_active","Date","initParticipants","local","Object","values","interval","setInterval","clearInterval","handleInitEvent","useCallback","evts","filter","idx","arr","findIndex","transact_UNSTABLE","forEach","some","reset","React","roomState","DailyRoom","updateRoom","meetingState","room","DailyProvider","props","callObject","setCallObject","eventsMap","_callFrameId","handleEvent","event","action","cb","initEventHandlers","keys","co","DailyIframe","createCallObject","Map","has","size","RecoilRoot","Provider","value","useParticipant","onParticipantLeft","onParticipantUpdated","useRecoilValue","filteredEvts","activeIdState","useActiveParticipant","ignoreLocal","onActiveSpeakerChange","recentActiveId","activeId","setActiveId","activeParticipant","useAppMessage","onAppMessage","sendAppMessage","data","to","handleAppMessage","mediaTrackState","atomFamily","state","subscribed","useMediaTrack","participantId","type","trackState","handleNewParticipantState","tracks","setInitialState","initialState","isOff","persistentTrack","undefined","useAudioTrack","generalCameraState","generalMicrophoneState","cameraDevicesState","microphoneDevicesState","speakerDevicesState","useDevices","camState","micState","camDevices","micDevices","speakerDevices","refreshDevices","navigator","mediaDevices","getUserMedia","enumerateDevices","devices","cams","d","kind","deviceId","mics","speakers","getInputDevices","camera","mic","speaker","mapDevice","device","prevDevices","selected","sortDeviceByLabel","a","b","label","prevCams","Boolean","sort","prevMics","prevSpeakers","e","updateDeviceStates","currentCamState","currentMicState","awaitingCamAccess","video","awaitingMicAccess","audio","blocked","byDeviceInUse","m","byDeviceMissing","byPermissions","errorMsg","audioOk","videoOk","setCamera","setInputDevicesAsync","audioDeviceId","videoDeviceId","setMicrophone","setSpeaker","setOutputDeviceAsync","outputDeviceId","cameras","hasCamError","includes","hasMicError","microphones","inputSettingsState","errorState","useInputSettings","onError","onInputSettingsUpdated","inputSettings","updateInputSettingsState","getInputSettings","then","updateInputSettings","liveStreamingState","isLiveStreaming","layout","useLiveStreaming","onLiveStreamingError","onLiveStreamingStarted","onLiveStreamingStopped","prevState","startLiveStreaming","options","stopLiveStreaming","updateLiveStreaming","useLocalParticipant","localId","useLocalSessionId","topologyState","networkQualityState","networkThresholdState","useNetwork","onNetworkConnection","onNetworkQualityChange","topology","quality","threshold","handleNetworkConnection","handleNetworkQualityChange","prevQuality","prevThreshold","getStats","newStats","getNetworkStats","stats","defaultFilter","defaultSort","useParticipantIds","onParticipantJoined","allParticipants","sortedIds","filterFn","owner","record","screen","sortFn","useParticipantProperty","propertyPath","participantReceiveSettingsState","useReceiveSettings","onReceiveSettingsUpdated","baseSettings","receiveSettings","ids","entries","settings","updateReceiveSettings","recordingState","isLocalParticipantRecorded","isRecording","useRecording","onRecordingData","onRecordingError","onRecordingStarted","onRecordingStopped","setState","useSetRecoilState","localSessionId","recordingParticipantIds","hasRecordingParticipants","isLocalParticipantRecording","s","preset","recordingId","recordingStartedDate","startedBy","startRecording","stopRecording","updateRecording","useRoom","useScreenAudioTrack","useScreenShare","onLocalScreenShareStarted","onLocalScreenShareStopped","startScreenShare","captureOptions","stopScreenShare","screenIds","screens","screenAudio","screenVideo","screenId","isSharingScreen","useScreenVideoTrack","useVideoTrack","waitingParticipantsState","waitingParticipantState","awaitingAccess","level","name","allWaitingParticipantsSelector","selector","useWaitingParticipants","onWaitingParticipantAdded","onWaitingParticipantRemoved","onWaitingParticipantUpdated","waitingParticipants","handleAdded","wps","handleRemoved","wp","handleUpdated","updateWaitingParticipantAccess","grantRequestedAccess","updateWaitingParticipants","updateWaitingParticipant","grantAccess","denyAccess"],"mappings":"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"}